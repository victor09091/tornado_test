<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta http-equiv="pragma" content="no-cache">
    <meta http-equiv="cache-control" content="no-cache">
    <meta http-equiv="expires" content="0">
    <meta http-equiv="keywords" content="keyword1,keyword2,keyword3">
    <meta http-equiv="description" content="ajax方式">
    <script src="http://apps.bdimg.com/libs/jquery/2.1.4/jquery.min.js"></script>
    <link rel="stylesheet" href="http://cdn.static.runoob.com/libs/bootstrap/3.3.7/css/bootstrap.min.css">
	<script src="http://cdn.static.runoob.com/libs/jquery/2.1.1/jquery.min.js"></script>
	<script src="http://cdn.static.runoob.com/libs/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <title>登录</title>

    <script type="text/javascript">
        var username;
        var password;
        var code;
        function loginFunc() {
             var username = $('#username').val();
             var password = $('#password').val();
             var code = $('#code').val();
             $.ajax({
                 type: "post",
                 dataType: "json",
                 url: "/login",
                 data: {username: username, password: password, code: code},
                 success: function (result) {
                         if (result.res)
                            alert("Data Saved: " + result.err_msg);
                         else
                             window.location.href="/login_success";
                 },
                 error: function () {
                     alert("异常！");
                 }
               });
        }

        function ChangeCode() {   //当点击图片的时候，会刷新图片，这一段代码就可以实现
            var code = document.getElementById('checkcode');
            code.src += "?";
        }
    </script>
</head>
<body>
      <div class="container">
        <div class="form row">
            <form class="form-horizontal col-sm-offset-3 col-md-offset-3">
                <h3 class="form-title">登录</h3>
                <div class="col-sm-9 col-md-9">
                    <div class="form-group">
                        <i class="fa fa-user fa-lg"></i>
                        <input class="form-control required" type="text" placeholder="姓名" name="username" id="username" autofocus="autofocus" maxlength="20"/>
                    </div>
                    <div class="form-group">
                            <i class="fa fa-lock fa-lg"></i>
                            <input class="form-control required" type="password" placeholder="密码" name="password" id="password" maxlength="8"/>
                    </div>
                    <div class="form-group">
                        <p>验证码: <input type="text" name="code" id="code">
                            <img src="/check_code" onclick="ChangeCode();" id = "checkcode">
                        </p>
                        <hr />
                        <a href="/register" id="register_btn" class="">Create an account</a>
                    </div>
                    <div>
                        <input type="submit" class="btn btn-success pull-middle"  onclick="loginFunc()" value="登录 " />
                    </div>
                </div>
            </form>
        </div>
      </div>
    <!--<div>-->
        <!--<p>用户名: <input type="text" name="username" id="username"> </p>-->
        <!--<p>密码: <input type="password" name="password" id="password"> </p>-->
        <!--<p>验证码: <input type="text" name="code" id="code">-->
            <!--<img src="/check_code" onclick="ChangeCode();" id = "checkcode">-->
        <!--</p>-->
        <!--&lt;!&ndash;<p><input type="submit" value="登录" onclick="loginFunc()"></p>&ndash;&gt;-->
        <!--<button type="submit" class="btn btn-primary" data-toggle="button"-->
                <!--onclick="loginFunc()">登录</button>-->

    <!--</div>-->
    <!--<a href="/register">注册</a>-->

</body>
</html>